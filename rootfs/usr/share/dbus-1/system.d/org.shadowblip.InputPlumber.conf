<?xml version="1.0" encoding="UTF-8"?>
<!-- -*- XML -*- -->
<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN" "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Only root can own the service -->
  <policy user="root">
    <allow own="org.shadowblip.InputPlumber"/>
  </policy>
  <!-- Anyone can send messages to the owner of org.shadowblip.InputPlumber -->
  <policy context="default">
    <allow send_destination="org.shadowblip.InputPlumber"/>

    <!-- Methods that allow input control are denied -->
    <deny send_destination="org.shadowblip.InputPlumber"
           send_interface="org.shadowblip.Input.Mouse" send_member="MoveCursor"/>
    <deny send_destination="org.shadowblip.InputPlumber"
           send_interface="org.shadowblip.Input.Keyboard" send_member="SendKey"/>
  </policy>
</busconfig>
